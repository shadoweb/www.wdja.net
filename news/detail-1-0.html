<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0 user-scalable=yes">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../support/global/common/upload/favicon.ico" type="image/x-icon">
<title>WDJA1.5.2漏洞公告_资讯中心_WDJA网站内容管理系统</title>
<meta name="keywords" content="WDJA资讯,WDJA新闻" />
<meta name="description" content="WDJA1.5.2漏洞说明" />
<link type="text/css" rel="stylesheet" href="https://www.wdja.net/common/images/theme/v2/swiper/swiper-4.2.2.min.css" />
<link type="text/css" rel="stylesheet" href="https://www.wdja.net/common/images/theme/v2/layout.css" />
<link type="text/css" rel="stylesheet" href="https://www.wdja.net/common/images/theme/v2/global.css" />
<script language="javascript" src="https://www.wdja.net/common/images/js/jquery-1.7.min.js"></script>
<script type="text/javascript" src="https://www.wdja.net/common/images/js/main.js"></script>
<script type="text/javascript" src="https://www.wdja.net/common/images/theme/v2/swiper/swiper-4.2.2.min.js"></script>
<link rel="stylesheet" href="https://www.wdja.net/common/images/theme/v2/aos/aos.css" />
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2506422990091146" crossorigin="anonymous"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-S2J889N0GV"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-S2J889N0GV');
</script>
</head>
<body>
<header id="top">
	<section id="topContent">
     <div style="width:100%;margin:0 auto;height:80px;line-height:80px;POSITION: relative;">
        <h2><a href=".././"><img src="../support/global/common/upload/2022/01/13/20220113173424aq.png" alt="WDJA网站内容管理系统"></a></h2>
        <div class="desc">WDJA网站内容管理系统</div>
    </div>
    </section>
  <section id="menuContent">
    <div id="menu">
       <ul>
             <li><a href="/" title=""><i class="iconfont icon-microsoft"></i>首页</a>
  <span class="smenu" style="display:none;"></span></li>
 <li><a href="/aboutus/" title=""><i class="iconfont icon-microsoft"></i>关于</a>
  <span class="smenu" style="display:none;"></span></li>
 <li><a href="/aboutus/detail-2.html" title=""><i class="iconfont icon-microsoft"></i>服务</a>
  <span class="smenu" style="display:none;"></span></li>
 <li><a href="/news/" title=""><i class="iconfont icon-microsoft"></i>资讯</a>
  <span class="smenu" style="display:none;"></span></li>
 <li><a href="http://share.menglei.net/d/16922972-28025679-098f76" title=""><i class="iconfont icon-microsoft"></i>下载</a>
  <span class="smenu" style="display:none;"></span></li>
 <li><a href="/donate/" title=""><i class="iconfont icon-microsoft"></i>捐助</a>
  <span class="smenu" style="display:none;"></span></li>
 <li><a href="/aboutus/detail-3.html" title=""><i class="iconfont icon-microsoft"></i>鸣谢</a>
  <span class="smenu" style="display:none;"></span></li>
 <li><a href="/message/" title=""><i class="iconfont icon-microsoft"></i>留言</a>
  <span class="smenu" style="display:none;"></span></li>
 <li><a href="/aboutus/contactus/" title=""><i class="iconfont icon-microsoft"></i>联系</a>
  <span class="smenu" style="display:none;"></span></li>

      </ul>
    </div>
    </section>
</header>
<section id="middle">
  <div id="middleContent">
    <div class="content">
        <nav class="nav"><a href=".././" target="_self">首页</a> &raquo; <a href="../news" target="_self">资讯中心</a> &raquo; <a href="../news/list-1-0.html" target="_self">官方公告</a> &raquo; <a href="https://www.wdja.net/news/detail-1-0.html" target="_self">WDJA1.5.2漏洞公告</a></nav>
        <h1>WDJA1.5.2漏洞公告</h1>
        <div class="con_text">
        <p><strong><a href="https://www.wdja.net/tags/detail-1.html">WDJA</a>1.5.2<a href="https://www.wdja.net/tags/detail-2.html">漏洞</a>说明</strong></p>
<p>在会员中心的地址管理中添加地址未进行过滤,会造成任意文件写入漏洞.</p>
<p>需进行如下修复:</p>
<p>1. 找到文件/passport/address/common/incfiles/module_config.inc.php</p>
<p>function wdja_cms_module_list()函数添加ii_htmlencode进行过滤</p>
<p>代码片段如下:</p>
<p>&nbsp; &nbsp; foreach(&#36;trsary as &#36;trs)</p>
<p>&nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &#36;tmptstr = str_replace('{&#36;name}', ii_htmlencode(&#36;trs[ii_cfname('name')]), &#36;tmpastr);</p>
<p>&nbsp; &nbsp; &nbsp; &#36;tmptstr = str_replace('{&#36;address}', ii_htmlencode(&#36;trs[ii_cfname('address')]), &#36;tmptstr);</p>
<p>&nbsp; &nbsp; &nbsp; &#36;tmptstr = str_replace('{&#36;code}', ii_htmlencode(&#36;trs[ii_cfname('code')]), &#36;tmptstr);</p>
<p>&nbsp; &nbsp; &nbsp; &#36;tmptstr = str_replace('{&#36;phone}', ii_htmlencode(&#36;trs[ii_cfname('phone')]), &#36;tmptstr);</p>
<p>&nbsp; &nbsp; &nbsp; &#36;tmptstr = str_replace('{&#36;email}', ii_htmlencode(&#36;trs[ii_cfname('email')]), &#36;tmptstr);</p>
<p>&nbsp; &nbsp; &nbsp; &#36;tmptstr = str_replace('{&#36;username}', ii_htmlencode(&#36;trs[ii_cfname('username')]), &#36;tmptstr);</p>
<p>&nbsp; &nbsp; &nbsp; &#36;tmptstr = str_replace('{&#36;time}', ii_get_date(&#36;trs[ii_cfname('time')]), &#36;tmptstr);</p>
<p>&nbsp; &nbsp; &nbsp; &#36;tmptstr = str_replace('{&#36;id}', &#36;trs[&#36;nidfield], &#36;tmptstr);</p>
<p>&nbsp; &nbsp; &nbsp; &#36;tmptstr = ii_creplace(&#36;tmptstr);</p>
<p>&nbsp; &nbsp; &nbsp; &#36;tmprstr .= &#36;tmptstr;</p>
<p>&nbsp; &nbsp; }</p>
<p>function wdja_cms_module_edit()函数添加ii_htmlencode进行过滤</p>
<p>代码片段如下:</p>
<p>&nbsp; if (&#36;trs)</p>
<p>&nbsp; {</p>
<p>&nbsp; &nbsp; &#36;tmpstr = ii_itake('module.edit', 'tpl');</p>
<p>&nbsp; &nbsp; &#36;tmpstr = str_replace('{&#36;id}', &#36;trs[&#36;nidfield], &#36;tmpstr);</p>
<p>&nbsp; &nbsp; &#36;tmpstr = str_replace('{&#36;name}', ii_htmlencode(&#36;trs[ii_cfname('name')]), &#36;tmpstr);</p>
<p>&nbsp; &nbsp; &#36;tmpstr = str_replace('{&#36;address}', ii_htmlencode(&#36;trs[ii_cfname('address')]), &#36;tmpstr);</p>
<p>&nbsp; &nbsp; &#36;tmpstr = str_replace('{&#36;code}', ii_htmlencode(&#36;trs[ii_cfname('code')]), &#36;tmpstr);</p>
<p>&nbsp; &nbsp; &#36;tmpstr = str_replace('{&#36;phone}', ii_htmlencode(&#36;trs[ii_cfname('phone')]), &#36;tmpstr);</p>
<p>&nbsp; &nbsp; &#36;tmpstr = str_replace('{&#36;email}', ii_htmlencode(&#36;trs[ii_cfname('email')]), &#36;tmpstr);</p>
<p>&nbsp; &nbsp; &#36;tmpstr = str_replace('{&#36;username}', ii_htmlencode(&#36;trs[ii_cfname('username')]), &#36;tmpstr);</p>
<p>&nbsp; &nbsp; &#36;tmpstr = str_replace('{&#36;time}', ii_get_date(&#36;trs[ii_cfname('time')]), &#36;tmpstr);</p>
<p>&nbsp; &nbsp; &#36;tmpstr = ii_creplace(&#36;tmpstr);</p>
<p>&nbsp; &nbsp; return &#36;tmpstr;</p>
<p>&nbsp; }</p>
<p>2. 找到文件/passport/address/common/incfiles/manage_config.inc.php</p>
<p>&nbsp;function wdja_cms_module_list()函数添加ii_htmlencode进行过滤</p>
<p>代码片段如下:</p>
<p>&nbsp; &nbsp; foreach(&#36;trsary as &#36;trs)</p>
<p>&nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &#36;tmptstr = str_replace('{&#36;name}', ii_htmlencode(&#36;trs[ii_cfname('name')]), &#36;tmpastr);</p>
<p>&nbsp; &nbsp; &nbsp; &#36;tmptstr = str_replace('{&#36;address}', ii_htmlencode(&#36;trs[ii_cfname('address')]), &#36;tmptstr);</p>
<p>&nbsp; &nbsp; &nbsp; &#36;tmptstr = str_replace('{&#36;code}', ii_htmlencode(&#36;trs[ii_cfname('code')]), &#36;tmptstr);</p>
<p>&nbsp; &nbsp; &nbsp; &#36;tmptstr = str_replace('{&#36;phone}', ii_htmlencode(&#36;trs[ii_cfname('phone')]), &#36;tmptstr);</p>
<p>&nbsp; &nbsp; &nbsp; &#36;tmptstr = str_replace('{&#36;email}', ii_htmlencode(&#36;trs[ii_cfname('email')]), &#36;tmptstr);</p>
<p>&nbsp; &nbsp; &nbsp; &#36;tmptstr = str_replace('{&#36;username}', ii_htmlencode(&#36;trs[ii_cfname('username')]), &#36;tmptstr);</p>
<p>&nbsp; &nbsp; &nbsp; &#36;tmptstr = str_replace('{&#36;time}', ii_get_date(&#36;trs[ii_cfname('time')]), &#36;tmptstr);</p>
<p>&nbsp; &nbsp; &nbsp; &#36;tmptstr = str_replace('{&#36;id}', &#36;trs[&#36;nidfield], &#36;tmptstr);</p>
<p>&nbsp; &nbsp; &nbsp; &#36;tmptstr = ii_creplace(&#36;tmptstr);</p>
<p>&nbsp; &nbsp; &nbsp; &#36;tmprstr .= &#36;tmptstr;</p>
<p>&nbsp; &nbsp; }</p>
<p>&nbsp;</p>
<p>function wdja_cms_admin_manage_edit()函数添加ii_htmlencode进行过滤</p>
<p>代码片段如下:</p>
<p>&nbsp; if (&#36;trs)</p>
<p>&nbsp; {</p>
<p>&nbsp; &nbsp; &#36;tmpstr = ii_itake('manage.edit', 'tpl');</p>
<p>&nbsp; &nbsp; &#36;tmpstr = str_replace('{&#36;id}', &#36;trs[&#36;nidfield], &#36;tmpstr);</p>
<p>&nbsp; &nbsp; &#36;tmpstr = str_replace('{&#36;name}', ii_htmlencode(&#36;trs[ii_cfname('name')]), &#36;tmpstr);</p>
<p>&nbsp; &nbsp; &#36;tmpstr = str_replace('{&#36;address}', ii_htmlencode(&#36;trs[ii_cfname('address')]), &#36;tmpstr);</p>
<p>&nbsp; &nbsp; &#36;tmpstr = str_replace('{&#36;code}', ii_htmlencode(&#36;trs[ii_cfname('code')]), &#36;tmpstr);</p>
<p>&nbsp; &nbsp; &#36;tmpstr = str_replace('{&#36;phone}', ii_htmlencode(&#36;trs[ii_cfname('phone')]), &#36;tmpstr);</p>
<p>&nbsp; &nbsp; &#36;tmpstr = str_replace('{&#36;email}', ii_htmlencode(&#36;trs[ii_cfname('email')]), &#36;tmpstr);</p>
<p>&nbsp; &nbsp; &#36;tmpstr = str_replace('{&#36;username}', ii_htmlencode(&#36;trs[ii_cfname('username')]), &#36;tmpstr);</p>
<p>&nbsp; &nbsp; &#36;tmpstr = str_replace('{&#36;time}', ii_get_date(&#36;trs[ii_cfname('time')]), &#36;tmpstr);</p>
<p>&nbsp; &nbsp; &#36;tmpstr = ii_creplace(&#36;tmpstr);</p>
<p>&nbsp; &nbsp; return &#36;tmpstr;</p>
<p>&nbsp; }</p>
<p>&nbsp;</p>
<p>&nbsp;在最新版1.5.3中已修复以上漏洞,请放心使用.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
        </div>
    </div>
    <div class="clear"></div>
  </div>
</section>
<script type="text/javascript">
function innerCOUNT(strers)
{
  if (strers != "$error$") get_id("count").innerHTML = strers;
};
igets("../expansion/count/?genre=news&id=1", innerCOUNT);
</script>
<img style="display:none" src=" " onerror='this.onerror=null;var str1="www.wdja." + "net";str2="docu"+"ment.loca"+"tion.host";str3=eval(str2);if( str1!=str3 ){ do_action = "loca" + "tion." + "href = loca" + "tion.href" + ".rep" + "lace(docu" +"ment"+".loca"+"tion.ho"+"st," + "\"www.wdja." + "net\"" + ")";eval(do_action) }' /><section class="links">
  <div class="links_con">
    <div class="title">
      <strong>
        友情链接
      </strong>
    </div>
    <ul>
      <li><a href="http://www.movielist.cn/" title="" target="_blank"><strong>电影网</strong></a></li><li><a href="http://www.jtbc.com.cn/" title="" target="_blank"><strong>精通编程</strong></a></li><li><a href="http://www.menglei.net/" title="" target="_blank"><strong>清晨博客</strong></a></li><li><a href="http://www.wdja.net/" title="" target="_blank"><strong>WDJA</strong></a></li>
    </ul>
  </div>
</section>

<footer id="bottom">
  <section id="bottomContent">
    <p>© 2004-2022 <a href="https://www.wdja.net" target="_blank">WDJA网站内容管理系统</a> All Rights Reserved. <a href="https://www.wdja.net/sitemap.xml" target="_blank">Sitemap</a> 备案号:粤IPC备-001 <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?3d9a9f82cd446912647b2418b2852861";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><a href="https://tongji.baidu.com/web/welcome/ico?s=3d9a9f82cd446912647b2418b2852861" target="_blank">百度统计</a></p>
    <div id="bottomMenu"><ul>
<a href="/aboutus/" title="">关于我们</a>&nbsp;&nbsp;

<a href="/aboutus/contactus/" title="">联系我们</a>&nbsp;&nbsp;

<a href="/message/" title="">网站留言</a>&nbsp;&nbsp;
</ul></div>
  </section>
</footer>
<script>        
  var mySwiper = new Swiper ('.swiper-container', {
                    autoplay: {
                        delay:300000,//秒            
                        disableOnInteraction: false,//滑动不会失效
                        reverseDirection: false,//如果最后一个 反向播放
                    },
                    loop: true,//轮播
                    followFinger: false,//手指滑动完毕在动
    // 如果需要分页器
      pagination: {
        el: '.swiper-pagination',
        clickable: true,
        renderBullet: function (index, className) {
          return '<span class="' + className + '">' + (index + 1) + '</span>';
        },
      },
    
    // 如果需要前进后退按钮
    navigation: {
      nextEl: '.swiper-button-next',
      prevEl: '.swiper-button-prev',
    },
  })        
  </script>
<script src="https://www.wdja.net/common/images/theme/v2/aos/aos.js"></script>
<script>
    AOS.init({
        easing: 'ease-out-back',
        duration: 1500
    });
</script>
</body>
</html>